{{ 'section-header.css' | asset_url | stylesheet_tag }}

<header class="header" data-header>
  <div class="page-width">
    <div class="header__wrapper">
      {%- comment -%} Mobile menu toggle {%- endcomment -%}
      <button
        class="header__menu-toggle desktop-hidden"
        aria-label="{{ 'accessibility.open_menu' | t }}"
        aria-expanded="false"
        aria-controls="mobile-menu"
        data-menu-toggle
      >
        {% render 'icon', icon: 'menu', size: 24 %}
      </button>

      {%- comment -%} Logo {%- endcomment -%}
      <div class="header__logo">
        <a href="{{ routes.root_url }}" class="header__logo-link">
          {%- if section.settings.logo != blank -%}
            {% render 'image',
              image: section.settings.logo,
              sizes: '200px',
              widths: '100, 150, 200',
              lazy: false,
              class: 'header__logo-image'
            %}
          {%- else -%}
            <span class="header__logo-text">{{ shop.name }}</span>
          {%- endif -%}
        </a>
      </div>

      {%- comment -%} Desktop navigation {%- endcomment -%}
      <nav class="header__nav mobile-hidden" aria-label="{{ 'header.menu' | t }}">
        <ul class="header__nav-list" role="list">
          {%- for link in section.settings.menu.links -%}
            <li class="header__nav-item{% if link.links.size > 0 %} header__nav-item--has-dropdown{% endif %}">
              {%- if link.links.size > 0 -%}
                <details class="header__dropdown">
                  <summary class="header__nav-link header__nav-link--dropdown">
                    {{ link.title }}
                    {% render 'icon', icon: 'chevron-down', size: 16 %}
                  </summary>
                  <ul class="header__dropdown-menu" role="list">
                    {%- for child_link in link.links -%}
                      <li>
                        <a href="{{ child_link.url }}" class="header__dropdown-link">
                          {{ child_link.title }}
                        </a>
                      </li>
                    {%- endfor -%}
                  </ul>
                </details>
              {%- else -%}
                <a href="{{ link.url }}" class="header__nav-link">
                  {{ link.title }}
                </a>
              {%- endif -%}
            </li>
          {%- endfor -%}
        </ul>
      </nav>

      {%- comment -%} Header icons {%- endcomment -%}
      <div class="header__icons">
        {%- if section.settings.show_search -%}
          <button
            class="header__icon-button"
            aria-label="{{ 'general.search' | t }}"
            data-search-toggle
          >
            {% render 'icon', icon: 'search', size: 22 %}
          </button>
        {%- endif -%}

        {%- if shop.customer_accounts_enabled -%}
          <a href="{%- if customer -%}{{ routes.account_url }}{%- else -%}{{ routes.account_login_url }}{%- endif -%}" class="header__icon-button mobile-hidden" aria-label="{{ 'header.account' | t }}">
            {% render 'icon', icon: 'user', size: 22 %}
          </a>
        {%- endif -%}

        <a href="{{ routes.cart_url }}" class="header__icon-button header__cart-icon" aria-label="{{ 'header.cart_count.other' | t: count: cart.item_count }}">
          {% render 'icon', icon: 'cart', size: 22 %}
          {%- if cart.item_count > 0 -%}
            <span class="header__cart-count" data-cart-count>
              {{ cart.item_count }}
            </span>
          {%- endif -%}
        </a>
      </div>
    </div>
  </div>

  {%- comment -%} Mobile menu {%- endcomment -%}
  <div id="mobile-menu" class="header__mobile-menu" hidden data-mobile-menu>
    <nav aria-label="{{ 'header.menu' | t }}">
      <ul class="header__mobile-nav" role="list">
        {%- for link in section.settings.menu.links -%}
          <li class="header__mobile-nav-item">
            {%- if link.links.size > 0 -%}
              <details class="header__mobile-dropdown">
                <summary class="header__mobile-nav-link">
                  {{ link.title }}
                  {% render 'icon', icon: 'chevron-down', size: 20 %}
                </summary>
                <ul class="header__mobile-dropdown-menu" role="list">
                  {%- for child_link in link.links -%}
                    <li>
                      <a href="{{ child_link.url }}" class="header__mobile-dropdown-link">
                        {{ child_link.title }}
                      </a>
                    </li>
                  {%- endfor -%}
                </ul>
              </details>
            {%- else -%}
              <a href="{{ link.url }}" class="header__mobile-nav-link">
                {{ link.title }}
              </a>
            {%- endif -%}
          </li>
        {%- endfor -%}
      </ul>

      {%- if shop.customer_accounts_enabled -%}
        <div class="header__mobile-account">
          <a href="{%- if customer -%}{{ routes.account_url }}{%- else -%}{{ routes.account_login_url }}{%- endif -%}" class="header__mobile-account-link">
            {% render 'icon', icon: 'user', size: 20 %}
            {%- if customer -%}
              {{ 'header.account' | t }}
            {%- else -%}
              {{ 'header.log_in' | t }}
            {%- endif -%}
          </a>
        </div>
      {%- endif -%}
    </nav>
  </div>
</header>

<script type="application/json" data-header-settings>
  {
    "stickyHeader": {{ section.settings.sticky_header | json }}
  }
</script>

{% schema %}
{
  "name": "Header",
  "tag": "section",
  "class": "section-header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "range",
      "id": "logo_width",
      "label": "Logo width",
      "min": 50,
      "max": 300,
      "step": 10,
      "default": 120,
      "unit": "px"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    },
    {
      "type": "checkbox",
      "id": "sticky_header",
      "label": "Enable sticky header",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_search",
      "label": "Show search icon",
      "default": true
    }
  ]
}
{% endschema %}
