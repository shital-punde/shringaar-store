<div class="main-password section">
  <div class="page-width">
    <div class="main-password__content">
      {%- if section.settings.logo != blank -%}
        <div class="main-password__logo">
          {% render 'image',
            image: section.settings.logo,
            sizes: '200px',
            widths: '100, 150, 200',
            lazy: false
          %}
        </div>
      {%- else -%}
        <h1 class="main-password__title">{{ shop.name }}</h1>
      {%- endif -%}

      <h2 class="main-password__heading">{{ 'password.title' | t }}</h2>
      <p class="main-password__subtext">{{ 'password.subtext' | t }}</p>

      {%- form 'customer', class: 'main-password__form' -%}
        <input type="hidden" name="contact[tags]" value="prospect, password page">

        <div class="main-password__input-wrapper">
          <label for="email" class="visually-hidden">{{ 'password.email_placeholder' | t }}</label>
          <input
            type="email"
            name="contact[email]"
            id="email"
            class="form-input"
            placeholder="{{ 'password.email_placeholder' | t }}"
            required
            autocomplete="email"
          >
          <button type="submit" class="button button--primary">
            {{ 'password.subscribe' | t }}
          </button>
        </div>

        {%- if form.posted_successfully? -%}
          <p class="main-password__success">{{ 'newsletter.success' | t }}</p>
        {%- endif -%}
      {%- endform -%}

      <button type="button" class="main-password__login-link" data-password-toggle>
        {{ 'password.enter_password' | t }}
      </button>
    </div>

    <div class="main-password__login" id="password-login" hidden>
      {%- form 'storefront_password', class: 'main-password__login-form' -%}
        <h3>{{ 'password.enter_password' | t }}</h3>

        {%- if form.errors -%}
          <div class="form-errors" role="alert">
            {{ form.errors | default_errors }}
          </div>
        {%- endif -%}

        <div class="main-password__input-wrapper">
          <label for="password" class="visually-hidden">{{ 'password.password_placeholder' | t }}</label>
          <input
            type="password"
            name="password"
            id="password"
            class="form-input"
            placeholder="{{ 'password.password_placeholder' | t }}"
            required
          >
          <button type="submit" class="button button--primary">
            {{ 'password.submit' | t }}
          </button>
        </div>
      {%- endform -%}

      <button type="button" class="main-password__back-link" data-password-toggle>
        {{ 'general.close' | t }}
      </button>
    </div>
  </div>
</div>

<script>
  document.querySelectorAll('[data-password-toggle]').forEach(function(btn) {
    btn.addEventListener('click', function() {
      var login = document.getElementById('password-login');
      login.hidden = !login.hidden;
    });
  });
</script>

{% schema %}
{
  "name": "Password page",
  "tag": "section",
  "class": "section-main-password",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    }
  ]
}
{% endschema %}
